\documentclass[a4paper,12pt]{article}
\usepackage{amsmath}
\usepackage[margin=0.9in]{geometry}
\usepackage{braket}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{quantikz}
\begin{document}
\subsection*{Exercise 4.1}
The eigenvectors are as follows:\\
Pauli $Z$: $\ket{0}$, $\ket{1}$\\
Pauli $X$: $\ket{0}+\ket{1}$, $\ket{0}-\ket{1}$\\
Pauli $Y$: $\ket{0}+i\ket{1}$, $\ket{0}-i\ket{1}$\\
Bloch sphere representations:

\includegraphics*[scale=0.4]{4.1.png}
\subsection*{Exercise 4.2}
exp$(iAx)=\displaystyle\sum_n(iAx)^n=
\displaystyle\sum_n(-1)^nx^{2n}I+\displaystyle\sum_n(-1)^nix^nA=
\cos(x)I+i\sin{x}A$
\subsection*{Exercise 4.3}
Up to a global phase:\\
$T=\noindent\begin{bmatrix}
    e^{-i\pi/8} &0\\
    0 & e^{i\pi/8}
\end{bmatrix}=
\begin{bmatrix}
    e^{-i\frac{\pi}{4}/2} &0\\
    0 & e^{i\frac{\pi}{4}/2}
\end{bmatrix}=
R_z(\pi/4)$
\subsection*{Exercise 4.4}
First consider $R_zR_xR_z$:\\
$R_zR_xR_z=\begin{bmatrix}
    \cos{\frac{\theta}{2}}e^{-i\theta} & -i\sin{\frac{\theta}{2}}\\
    -i\sin{\frac{\theta}{2}} & \cos{\frac{\theta}{2}}e^{i\theta}
\end{bmatrix}$\\
For $\theta=\frac{\pi}{2}$:\\
$R_zR_xR_z=\frac{1}{\sqrt{2}}\begin{bmatrix}
  e^{-i\frac{\pi}{2}} &  e^{-i\frac{\pi}{2}} \\
  e^{-i\frac{\pi}{2}}  & e^{i\frac{\pi}{2}}
\end{bmatrix}$\\
Hence, by multiplying by $e^{i\frac{\pi}{2}}$ we get,\\
$e^{i\frac{\pi}{2}}R_zR_xR_z=\frac{1}{\sqrt{2}}\begin{bmatrix}
    1 &  1 \\
   1  & -1
  \end{bmatrix}=H$\\
\subsection*{Exercise 4.5}
We have $n_x^2+n_y^2+n_z^2=1$\\
$\hat{n}\cdot\vec{\sigma}=\begin{bmatrix}
    n_z& n_x-in_y\\
    n_x+in_y& n_z
\end{bmatrix}$\\
Therefore,\\
$(\hat{n}\cdot\vec{\sigma})^2=\begin{bmatrix}
    n_x^2+n_y^2+n_z^2&0\\
    0&n_x^2+n_y^2+n_z^2
\end{bmatrix}=\begin{bmatrix}
    1&0\\
    0&1
\end{bmatrix}=I$\\
Consider, $R_n(\theta)R_n(-\theta)$\\
$I=R_n(\theta)R_n(-\theta)=(\cos(\frac{\theta}{2})I-\sin(\frac{\theta}{2})\hat{n}\cdot\vec{\sigma})
(\cos(\frac{\theta}{2})I+\sin(\frac{\theta}{2})\hat{n}\cdot\vec{\sigma})=
\cos^2(\frac{\theta}{2})I+\sin^2(\frac{\theta}{2})(\hat{n}\cdot\vec{\sigma})^2=
(\cos^2(\frac{\theta}{2})+\sin^2(\frac{\theta}{2}))I=I$
\subsection*{Exercise 4.6}
First, let's show that $R_Z(x)$ rotates around the Z-axis by an angle $x$.
Consider the general state $\ket{\psi}=\begin{pmatrix}
    \cos\frac{\theta}{2}\\
    e^{i\phi}\sin\frac{\theta}{2}
\end{pmatrix}$. Then,\\
$R_Z(x)\ket{\psi}=(\cos\frac{x}{2}I-i\sin\frac{x}{2}Z)\begin{pmatrix}
    \cos\frac{\theta}{2}\\
    e^{i\phi}\sin\frac{\theta}{2}
\end{pmatrix}=
\cos\frac{x}{2}\begin{pmatrix}
    \cos\frac{\theta}{2}\\
    e^{i\phi}\sin\frac{\theta}{2}
\end{pmatrix}-i\sin\frac{x}{2}\begin{pmatrix}
    \cos\frac{\theta}{2}\\
    -e^{i\phi}\sin\frac{\theta}{2}
\end{pmatrix}=
\begin{pmatrix}
    e^{-ix/2}\cos\frac{\theta}{2}\\
    e^{ix/2}e^{i\phi}\sin\frac{\theta}{2}
\end{pmatrix}=
\begin{pmatrix}
    \cos\frac{\theta}{2}\\
    e^{i(\phi+x)}\sin\frac{\theta}{2}
\end{pmatrix}$\\
Hence, the state has been rotated by $x$ around the Z-axis. Similarly, we get
that $R_X(x)$ and $R_Y(x)$ rotate around the X and Y axis respectively.\\
We also have that,\\
$R_n(x)=\cos\frac{x}{2}I-i\sin\frac{x}{2}(n_xX+n_yY+n_ZZ)=
\cos\frac{x}{2}I-i\sin\frac{x}{2}(\sin\theta_n\cos\phi_nX+\sin\theta_n\sin\theta_nY
+\cos\theta_nZ)=R_Z(\phi_n)R_X(\theta_n)(\cos\frac{x}{2}I-i\sin\frac{x}{2}Z) R_X(\theta_n)^\dagger R_Z(\phi_n)^\dagger=
R_Z(\phi_n)R_X(\theta_n)R_Z(x) R_X(\theta_n)^\dagger R_Z(\phi_n)^\dagger$\\
Therefore, $R_n(x)$ rotates the axis of rotation to the Z axis performs the rotations
by angle $x$ and then returns the axis back to $n$, which is the same as rotating around $n$
by an angle $x$. 
\subsection*{Exercise 4.7}
$\{X,Y\}=1$ therefore, $XYX=-XXY=-Y$.\\
$XR_Y(\theta)X=X(\cos\frac{\theta}{2}I-i\sin\frac{\theta}{2}Y)X=\cos\frac{\theta}{2}I+i\sin\frac{\theta}{2}Y=R_Y(-\theta)$
\subsection*{Exercise 4.8}
Any 2x2 unitary matrix for $a^2+b^2+c^2+d^2=1$ can be written as,\\
1)$U=e^{i\alpha}\begin{bmatrix}
    a+ib&c+id\\
    -c+id& a-ib
\end{bmatrix}$\\
Consider, the given form for $U$,\\
$U=e^{i\alpha}R_n(\theta)=e^{i\alpha}\begin{bmatrix}
    \cos\frac{\theta}{2}-i\sin\frac{\theta}{2}n_z & -\sin\frac{\theta}{2}(n_y+in_x)\\
    \sin\frac{\theta}{2}(n_y-in_x)& \cos\frac{\theta}{2}+i\sin\frac{\theta}{2}n_z
\end{bmatrix}$\\
As, $n_x^2+n_y^2+n_z^2=1$ this has the same form as the general $U$, hence any 
arbitrary 2x2 unitary matrix can be written as $U=e^{i\alpha}R_n(\theta)$.\\
2) $n_z=\frac{1}{\sqrt{2}}$, $n_y=0$, $n_x=\frac{1}{\sqrt{2}}$,
$\alpha=0$ and $\theta=\pi$.\\
3) $n_x,n_y=0$, $n_z=1$, $\alpha =\theta=\frac{\pi}{4}$.
\subsection*{Exercise 4.9}
We can write,\\
$U=\begin{bmatrix}
    e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2} & -e^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}\\
    e^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2} & e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}
\end{bmatrix}=e^{i\alpha}
\begin{bmatrix}
    e^{i(-\beta/2-\delta/2)}\cos\frac{\gamma}{2} & -e^{i(-\beta/2+\delta/2)}\sin\frac{\gamma}{2}\\
    e^{i(\beta/2-\delta/2)}\sin\frac{\gamma}{2} & e^{i(\beta/2+\delta/2)}\cos\frac{\gamma}{2}
\end{bmatrix}=e^{i\alpha}
\begin{bmatrix}
    a & b\\
    -b^* & a^*
\end{bmatrix}$\\
which is the general form of a 2x2 unitary matrix as $det(U)=\cos^2\frac{\gamma}{2}+
\sin^2\frac{\gamma}{2}=1$.
\subsection*{Exercise 4.10}
$U=e^{i\alpha}R_Z(\beta)R_X(\gamma)R_Z(\delta)=\begin{bmatrix}
    e^{i(\alpha-\beta/2-\delta/2)}\cos\frac{\gamma}{2} & -ie^{i(\alpha-\beta/2+\delta/2)}\sin\frac{\gamma}{2}\\
    -ie^{i(\alpha+\beta/2-\delta/2)}\sin\frac{\gamma}{2} & e^{i(\alpha+\beta/2+\delta/2)}\cos\frac{\gamma}{2}
\end{bmatrix}$\\
which once again is a unitary matrix.
\subsection*{Exercise 4.11}
\subsection*{Exercise 4.12}
From the proof of Corollary 4.2 we have, $AXBXC=R_Z(\beta)R_Y(\gamma)R_Z(\delta)$. We can see
that $\alpha=\gamma=\delta=\frac{\pi}{2}$ and $\beta=0$ gives $H$. Hence, we can take
$A=R_Y(\frac{\pi}{4})$,$B=R_Y(-\frac{\pi}{4})R_Z(-\frac{\pi}{4})$ and $C=R_Z(\frac{\pi}{4})$.
\subsection*{Exercise 4.13}
$HXH=\frac{1}{2}\begin{bmatrix}
    1&1\\
    1&-1
\end{bmatrix}
\begin{bmatrix}
    0&1\\
    1&0
\end{bmatrix}
\begin{bmatrix}
    1&1\\
    1&-1
\end{bmatrix}=
\frac{1}{2}
\begin{bmatrix}
    2&0\\
    0&-2
\end{bmatrix}=Z$\\
$HYH=\frac{1}{2}\begin{bmatrix}
    1&1\\
    1&-1
\end{bmatrix}
\begin{bmatrix}
    0&-i\\
    i&0
\end{bmatrix}
\begin{bmatrix}
    1&1\\
    1&-1
\end{bmatrix}=
\frac{1}{2}
\begin{bmatrix}
    0&2i\\
    -2i&0
\end{bmatrix}=-Y$
$HZH=HHXHH=X$
\subsection*{Exercise 4.14}
$T=R_Z(\frac{\pi}{4})$\\
$HTH=HR_Z(\frac{\pi}{4})H=H(\cos\frac{\pi}{8}-i\sin\frac{\pi}{8}Z)H=
\cos\frac{\pi}{8}-i\sin\frac{\pi}{8}X=R_X(\frac{\pi}{4})$
\subsection*{Exercise 4.15}
(Check Errata for the sign in the second equation)
1)$R_{\hat{n}_2}(\beta_2)R_{\hat{n}_1}(\beta_1)=
(c_2I-is_2\hat{n}_2.\sigma)(c_1I-is_1\hat{n}_1.\sigma)=
c_1c_2I-s_1s_2(\hat{n}_2.\sigma)(\hat{n}_1.\sigma) -ic_2s_1\hat{n}_1.\sigma
-ic_1s_2\hat{n}_2.\sigma=
c_1c_2I-s_1s_2(\hat{n}_1.\hat{n}_2I+i(\hat{n}_2\times\hat{n}_1).\sigma)-ic_2s_1\hat{n}_1.\sigma
-ic_1s_2\hat{n}_2.\sigma=
(c_1c_2-s_1s_2\hat{n}_1.\hat{n}_2)I-i(c_2s_1\hat{n}_1
+c_1s_2\hat{n}_2+s_1s_2\hat{n}_2\times\hat{n}_1).\sigma$\\
Therefore,\\
$c_{12}=c_1c_2-s_1s_2\hat{n}_1.\hat{n}_2\\
s_{12}\hat{n}_{12}=c_2s_1\hat{n}_1
+c_1s_2\hat{n}_2+s_1s_2\hat{n}_2\times\hat{n}_1$\\
2)$\beta_1=\beta_2$ and $\hat{n}_1=\hat{z}$, hence $c_1=c_2=c$ and $s_1=s_2=s$.
Therefore,\\
$c_{12}=c^2-s^2\hat{z}.\hat{n}_2\\
s_{12}\hat{n}_{12}=cs(\hat{z}
+\hat{n}_2)+s^2\hat{n}_2\times\hat{z}$
\subsection*{Exercise 4.16}
$H_1=\frac{1}{\sqrt{2}}\begin{bmatrix}
    I&I\\
    I&-I
\end{bmatrix}$\\
$H_2=\frac{1}{\sqrt{2}}\begin{bmatrix}
    H&0\\
    0&H
\end{bmatrix}$
\subsection*{Exercise 4.17}
$\begin{bmatrix}
    H&0\\
    0&H
\end{bmatrix}
\begin{bmatrix}
    I&0\\
    0&Z
\end{bmatrix}
\begin{bmatrix}
    H&0\\
    0&H
\end{bmatrix}=
\begin{bmatrix}
    HH&0\\
    0&HZH
\end{bmatrix}=
\begin{bmatrix}
    I&0\\
    0&X
\end{bmatrix}=CNOT$
\subsection*{Exercise 4.18}
When the second qubit is the control we have the following representation,\\
$CZ_2=\ket{00}\bra{00}+\ket{01}\bra{01}-\ket{11}\bra{11}+\ket{10}\bra{10}=
\begin{bmatrix}
    1&0&0&0\\
    0&1&0&0\\
    0&0&1&0\\
    0&0&0&-1
\end{bmatrix}$
\subsection*{Exercise 4.19}
$\text{CNOT}\rho\text{CNOT}=\begin{bmatrix}
    I&0\\
    0&X
\end{bmatrix}
\begin{bmatrix}
    A&B\\
    C&D
\end{bmatrix}
\begin{bmatrix}
    I&0\\
    0&X
\end{bmatrix}=
\begin{bmatrix}
    A&XB\\
    XC&XDX
\end{bmatrix}$\\
$X$ only rearranges elements, hence the CNOT only rearranges the elements of $\rho$.
\subsection*{Exercise 4.20}
$(H_1\otimes H_2)\text{CNOT}(H_1\otimes H_2)=\frac{1}{2}
\begin{bmatrix}
    H&H\\
    H&-H    
\end{bmatrix}
\begin{bmatrix}
    I&0\\
    0&X    
\end{bmatrix}
\begin{bmatrix}
    H&H\\
    H&-H    
\end{bmatrix}=\frac{1}{2}
\begin{bmatrix}
    HH+HXH&HH-HXH\\
    HH-HXH&HH+HXH    
\end{bmatrix}=\frac{1}{2}
\begin{bmatrix}
    I+Z&I-Z\\
    I-Z&I+Z    
\end{bmatrix}=
\begin{bmatrix}
    1&0&0&0\\
    0&0&0&1\\
    0&0&1&0\\
    0&1&0&0
\end{bmatrix}=\text{CNOT(2\textsuperscript{nd} qubit control)}$\\
The left circuit transforms between the $\ket{0}$,$\ket{1}$ and $\ket{+}$,$\ket{-}$ basis applies a CNOT and transforms back.
Hence, the effect of the CNOT on the $\ket{\pm}\ket{\pm}$ is the same as applying the CNOT with the 2\textsuperscript{nd}
qubit as target to the state in the $\ket{0}$,$\ket{1}$ basis 
and then replacing $0$ with $+$ and $1$ with $-$. This process does indeed give the equations 4.24-4.27.
\subsection*{Exercise 4.21}
Consider all the possible inputs,\\
$\ket{00\psi}\rightarrow\ket{00\psi}\rightarrow\ket{00\psi}\rightarrow\ket{00\psi}\rightarrow\ket{00\psi}\rightarrow\ket{00\psi}\\
\ket{01\psi}\rightarrow\ket{01(V\psi)}\rightarrow\ket{01(V\psi)}\rightarrow\ket{01(V^\dagger V\psi)}\rightarrow\ket{01\psi}\rightarrow\ket{01\psi}\\
\ket{10\psi}\rightarrow\ket{10\psi}\rightarrow\ket{11\psi}\rightarrow\ket{11(V^\dagger\psi)}\rightarrow\ket{10(VV^\dagger\psi)}\rightarrow\ket{10\psi}\\
\ket{11\psi}\rightarrow\ket{11(V\psi)}\rightarrow\ket{10(V\psi)}\rightarrow\ket{11(V\psi)}\rightarrow\ket{11(VV\psi)}\rightarrow\ket{11U\psi}$\\
Hence, the circuit does perform the $C^2(U)$ operation.
\newpage
\subsection*{Exercise 4.22}
Firstly, we apply the circuit in figure 4.6 to the circuit in figure 4.8 for $V=e^{i\alpha}AXBXC$, which gives,\\
$\begin{quantikz}
    &\qw&\qw & \qw&\qw &\qw &\ctrl{1} & \qw& \qw&\qw&\qw&\qw&\ctrl{1}&\qw&\ctrl{2}&\qw&\ctrl{2}&\phase{\alpha}&\qw\\
    &\qw&\ctrl{1}&\qw&\ctrl{1}&\phase{\alpha}&\targ{}&\phase{-\alpha}&\ctrl{1}&\qw&\ctrl{1}&\qw&\targ{}&\qw&\qw&\qw&\qw&\qw&\qw\\
    &\gate{C}&\targ{}&\gate{B}&\targ{}&\gate{A}&\qw&\gate{A^\dagger}&\targ{}&\gate{B^\dagger}&\targ{}&\gate{C^\dagger}&\qw&\gate{C}&\targ{}&\gate{B}&\targ{}&\gate{A}&\qw
\end{quantikz}$\\
We move the 6\textsuperscript{th} CNOT left from the 4\textsuperscript{th} one, which involves adding CNOTs
after the 4\textsuperscript{th} and 5\textsuperscript{th} CNOTs from first to third qubit, which is due to,\\
$\begin{quantikz}
    &\qw&\ctrl{1}&\qw\\
    &\ctrl{1}&\targ{}&\qw\\
    &\targ{}&\qw&\qw
\end{quantikz}=
\begin{quantikz}
    &\ctrl{1}&\qw&\ctrl{2}&\qw\\
    &\targ{}&\ctrl{1}&\qw&\qw\\
    &\qw&\targ{}&\targ{}&\qw
\end{quantikz}$\\

and can be checked by considering all the possible inputs. We also see that $AA^\dagger=CC^\dagger=I$.
Hence we get the following circuit.\\
$\begin{quantikz}
    &\qw&\qw & \qw&\qw &\phase{\alpha}\gategroup[wires=2, steps=4, style={dashed}]{} &\ctrl{1} & \qw& \ctrl{1}&\qw&\ctrl{2}&\qw&\qw&\ctrl{2}&\ctrl{2}&\qw&\ctrl{2}&\qw&\qw\\
    &\qw&\ctrl{1}&\qw&\ctrl{1}&\phase{\alpha}&\targ{}&\phase{-\alpha}&\targ{}&\ctrl{1}&\qw&\qw&\ctrl{1}&\qw&\qw&\qw&\qw&\qw&\qw\\
    &\gate{C}&\targ{}&\gate{B}&\targ{}&\qw&\qw&\qw&\qw&\targ{}&\targ{}&\gate{B^\dagger}&\targ{}&\targ&\qw&\targ{}&\gate{B}&\targ{}&\gate{A}&\qw
\end{quantikz}$\\

The dashed section is diagonal hence commutes with the rest of the components therefore can be moved to the end
for convenience.\\
$\begin{quantikz}
    &\qw&\qw & \qw&\qw &\qw&\ctrl{2}&\qw&\qw&\ctrl{2}&\ctrl{2}&\qw&\ctrl{2}&\qw&\phase{\alpha} &\ctrl{1} & \qw& \ctrl{1}&\qw\\
    &\qw&\ctrl{1}&\qw&\ctrl{1}&\ctrl{1}&\qw&\qw&\ctrl{1}&\qw&\qw&\qw&\qw&\qw&\phase{\alpha}&\targ{}&\phase{-\alpha}&\targ{}&\qw\\
    &\gate{C}&\targ{}&\gate{B}&\targ{}&\targ{}&\targ{}&\gate{B^\dagger}&\targ{}&\targ&\qw&\targ{}&\gate{B}&\targ{}&\gate{A}&\qw&\qw&\qw&\qw&\qw
\end{quantikz}$\\

CNOTs 2 and 3, and 6 and 7 cancel each other, hence we're left with the circuit.\\
$\begin{quantikz}
    &\qw&\qw & \qw&\ctrl{2}&\qw&\qw&\qw&\ctrl{2}&\qw&\phase{\alpha} &\ctrl{1} & \qw& \ctrl{1}&\qw\\
    &\qw&\ctrl{1}&\qw&\qw&\qw&\ctrl{1}&\qw&\qw&\qw&\phase{\alpha}&\targ{}&\phase{-\alpha}&\targ{}&\qw\\
    &\gate{C}&\targ{}&\gate{B}&\targ{}&\gate{B^\dagger}&\targ{}&\gate{B}&\targ{}&\gate{A}&\qw&\qw&\qw&\qw&\qw
\end{quantikz}$\\

This has 8 single qubit gates and 6 CNOTs as desired.\\
The circuit performs the operation, $AXBXB^\dagger XBXC=(VC^\dagger)B^\dagger(A^\dagger V)=V(ABC)^\dagger =V^2=U$.
Therefore, the circuit performs the $C^2(U)$ operation.
\subsection*{Exercise 4.23}
\end{document}